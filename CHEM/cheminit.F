
#include "ctrparam.h"

!	============================================================
!
!	CHEMINIT.F:	Subroutine for initialization of tracers
!				in MIT Global Chemistry Model
!
!	------------------------------------------------------------
!
!	Author:		Chien Wang
!			MIT Joint Program on Science and Policy
!				of Global Change
!
!	----------------------------------------------------------
! 
!	Revision History:
!	
!	When	Who		What
!	----	----------	-------
!	052200	Chien Wang	rev.	
!	080200	Chien Wang	repack based on CliChem3 & add cpp
!	101800	Chien Wang	replaced if_3gases with cpp
!	112800	Chien Wang	add extra edaily for meta particles
!	113000	Chien Wang	add read n_total_urban & n_urban
!	121800	Chien Wang	move initialization of xnoxltnt here
!	092001	Chien Wang	add bc and oc
!	051604	Chien Wang	add back four missing reading lines
!	062304	Chien Wang	add drydep 46 data & delete block data
!
!	==========================================================

!
	subroutine cheminit(ISTRT1,pt,qv)
!	=================================

#include "chem_para"
#include "chem_com"
#include "chem_meta"

	dimension pt(nlon,nlat,nlev)
	dimension qv(nlon,nlat,nlev)

#if ( defined CPL_CHEM )
#if ( N_LAT == 24 )
      	ddepno (1,1:nlat) = (/
     &     -0.2300E-08, -0.2300E-08, -0.2558E-08, -0.3597E-08,
     &     -0.3272E-08, -0.3715E-08, -0.3993E-08, -0.5103E-08,
     &     -0.6727E-08, -0.7102E-08, -0.6618E-08, -0.7047E-08,
     &     -0.6805E-08, -0.7037E-08, -0.8250E-08, -0.9527E-08,
     &     -0.9802E-08, -0.1062E-07, -0.9616E-08, -0.7989E-08,
     &     -0.5587E-08, -0.3989E-08, -0.2755E-08, -0.2300E-08
     &                                                      /)
      	ddepno2 (1,1:nlat) = (/
     &     -0.1150E-07, -0.1150E-07, -0.1408E-07, -0.2137E-07,
     &     -0.2119E-07, -0.2463E-07, -0.2634E-07, -0.3318E-07,
     &     -0.4317E-07, -0.4548E-07, -0.4249E-07, -0.4514E-07,
     &     -0.4364E-07, -0.4507E-07, -0.5254E-07, -0.6040E-07,
     &     -0.6209E-07, -0.6715E-07, -0.6025E-07, -0.4973E-07,
     &     -0.3368E-07, -0.2381E-07, -0.1502E-07, -0.1150E-07
     &                                                      /)
      	ddephno3 (1,1:nlat) = (/
     &     -0.5750E-06, -0.5750E-06, -0.7042E-06, -0.1006E-05,
     &     -0.1059E-05, -0.1211E-05, -0.1275E-05, -0.1532E-05,
     &     -0.1906E-05, -0.1993E-05, -0.1881E-05, -0.1980E-05,
     &     -0.1924E-05, -0.1978E-05, -0.2258E-05, -0.2552E-05,
     &     -0.2616E-05, -0.2806E-05, -0.2524E-05, -0.2113E-05,
     &     -0.1471E-05, -0.1099E-05, -0.7304E-06, -0.5750E-06
     &                                                      /)
      	ddepn2o5 (1,1:nlat) = (/
     &     -0.5750E-06, -0.5750E-06, -0.7042E-06, -0.1006E-05,
     &     -0.1059E-05, -0.1211E-05, -0.1275E-05, -0.1532E-05,
     &     -0.1906E-05, -0.1993E-05, -0.1881E-05, -0.1980E-05,
     &     -0.1924E-05, -0.1978E-05, -0.2258E-05, -0.2552E-05,
     &     -0.2616E-05, -0.2806E-05, -0.2524E-05, -0.2113E-05,
     &     -0.1471E-05, -0.1099E-05, -0.7304E-06, -0.5750E-06
     &                                                      /)
      	ddepo3 (1,1:nlat) = (/
     &     -0.8050E-07, -0.8050E-07, -0.8050E-07, -0.1010E-06,
     &     -0.8064E-07, -0.8722E-07, -0.9428E-07, -0.1225E-06,
     &     -0.1637E-06, -0.1732E-06, -0.1609E-06, -0.1718E-06,
     &     -0.1657E-06, -0.1715E-06, -0.2024E-06, -0.2348E-06,
     &     -0.2417E-06, -0.2626E-06, -0.2416E-06, -0.2037E-06,
     &     -0.1510E-06, -0.1107E-06, -0.8731E-07, -0.8050E-07
     &                                                      /)
      	ddeph2o2 (1,1:nlat) = (/
     &     -0.3680E-06, -0.3680E-06, -0.5437E-06, -0.6702E-06,
     &     -0.1025E-05, -0.1140E-05, -0.1129E-05, -0.1086E-05,
     &     -0.1024E-05, -0.1010E-05, -0.1028E-05, -0.1012E-05,
     &     -0.1021E-05, -0.1012E-05, -0.9654E-06, -0.9163E-06,
     &     -0.9057E-06, -0.8741E-06, -0.7831E-06, -0.7509E-06,
     &     -0.6073E-06, -0.6612E-06, -0.4848E-06, -0.3680E-06
     &                                                      /)
      	ddepch3o2h (1,1:nlat) = (/
     &     -0.1150E-07, -0.1150E-07, -0.7351E-07, -0.1198E-06,
     &     -0.2433E-06, -0.2844E-06, -0.2812E-06, -0.2684E-06,
     &     -0.2497E-06, -0.2454E-06, -0.2509E-06, -0.2460E-06,
     &     -0.2488E-06, -0.2461E-06, -0.2321E-06, -0.2174E-06,
     &     -0.2142E-06, -0.2047E-06, -0.1709E-06, -0.1565E-06,
     &     -0.1016E-06, -0.1174E-06, -0.5326E-07, -0.1150E-07
     &                                                      /)
        ddepbc (1,1:nlat) = (/
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06
     &                                                      /)
        ddepoc (1,1:nlat) = (/
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06
     &                                                      /)
      	ddepref (1,1:nlat) = (/
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00
     &     /)
#endif 

#if ( N_LAT == 46 )
        ddepno (1,1:nlat) = (/
     &  -0.2300E-08,  -0.2300E-08,  -0.2306E-08,  -0.2438E-08,
     &  -0.2604E-08,  -0.3135E-08,  -0.3575E-08,  -0.3409E-08,
     &  -0.3311E-08,  -0.3538E-08,  -0.3746E-08,  -0.3888E-08,
     &  -0.4141E-08,  -0.4708E-08,  -0.5356E-08,  -0.6186E-08,
     &  -0.6794E-08,  -0.6985E-08,  -0.7005E-08,  -0.6758E-08,
     &  -0.6713E-08,  -0.6933E-08,  -0.6988E-08,  -0.6864E-08,
     &  -0.6867E-08,  -0.6985E-08,  -0.7387E-08,  -0.8007E-08,
     &  -0.8647E-08,  -0.9300E-08,  -0.9619E-08,  -0.9759E-08,
     &  -0.1009E-07,  -0.1051E-07,  -0.1024E-07,  -0.9728E-08,
     &  -0.8965E-08,  -0.8134E-08,  -0.6975E-08,  -0.5747E-08,
     &  -0.4877E-08,  -0.4060E-08,  -0.3413E-08,  -0.2782E-08,
     &  -0.2533E-08,  -0.2300E-08
     &     /)

        ddepno2 (1,1:nlat) = (/
     &  -0.1150E-07,  -0.1150E-07,  -0.1156E-07,  -0.1288E-07,
     &  -0.1440E-07,  -0.1813E-07,  -0.2136E-07,  -0.2127E-07,
     &  -0.2150E-07,  -0.2325E-07,  -0.2482E-07,  -0.2569E-07,
     &  -0.2725E-07,  -0.3075E-07,  -0.3473E-07,  -0.3984E-07,
     &  -0.4358E-07,  -0.4476E-07,  -0.4488E-07,  -0.4335E-07,
     &  -0.4308E-07,  -0.4443E-07,  -0.4477E-07,  -0.4401E-07,
     &  -0.4402E-07,  -0.4475E-07,  -0.4723E-07,  -0.5105E-07,
     &  -0.5499E-07,  -0.5900E-07,  -0.6096E-07,  -0.6183E-07,
     &  -0.6389E-07,  -0.6648E-07,  -0.6454E-07,  -0.6102E-07,
     &  -0.5604E-07,  -0.5067E-07,  -0.4295E-07,  -0.3475E-07,
     &  -0.2929E-07,  -0.2425E-07,  -0.1971E-07,  -0.1522E-07,
     &  -0.1330E-07,  -0.1150E-07
     &     /)

        ddephno3 (1,1:nlat) = (/
     &  -0.5750E-06,  -0.5750E-06,  -0.5779E-06,  -0.6439E-06,
     &  -0.7176E-06,  -0.8719E-06,  -0.1010E-05,  -0.1037E-05,
     &  -0.1073E-05,  -0.1150E-05,  -0.1218E-05,  -0.1251E-05,
     &  -0.1309E-05,  -0.1441E-05,  -0.1590E-05,  -0.1781E-05,
     &  -0.1921E-05,  -0.1966E-05,  -0.1971E-05,  -0.1913E-05,
     &  -0.1903E-05,  -0.1954E-05,  -0.1966E-05,  -0.1938E-05,
     &  -0.1938E-05,  -0.1966E-05,  -0.2059E-05,  -0.2202E-05,
     &  -0.2349E-05,  -0.2500E-05,  -0.2573E-05,  -0.2606E-05,
     &  -0.2684E-05,  -0.2781E-05,  -0.2699E-05,  -0.2555E-05,
     &  -0.2360E-05,  -0.2150E-05,  -0.1842E-05,  -0.1514E-05,
     &  -0.1306E-05,  -0.1116E-05,  -0.9270E-06,  -0.7386E-06,
     &  -0.6544E-06,  -0.5750E-06
     &     /)

          ddepn2o5 (1,1:nlat) = (/
     &  -0.5750E-06,  -0.5750E-06,  -0.5779E-06,  -0.6439E-06,
     &  -0.7176E-06,  -0.8719E-06,  -0.1010E-05,  -0.1037E-05,
     &  -0.1073E-05,  -0.1150E-05,  -0.1218E-05,  -0.1251E-05,
     &  -0.1309E-05,  -0.1441E-05,  -0.1590E-05,  -0.1781E-05,
     &  -0.1921E-05,  -0.1966E-05,  -0.1971E-05,  -0.1913E-05,
     &  -0.1903E-05,  -0.1954E-05,  -0.1966E-05,  -0.1938E-05,
     &  -0.1938E-05,  -0.1966E-05,  -0.2059E-05,  -0.2202E-05,
     &  -0.2349E-05,  -0.2500E-05,  -0.2573E-05,  -0.2606E-05,
     &  -0.2684E-05,  -0.2781E-05,  -0.2699E-05,  -0.2555E-05,
     &  -0.2360E-05,  -0.2150E-05,  -0.1842E-05,  -0.1514E-05,
     &  -0.1306E-05,  -0.1116E-05,  -0.9270E-06,  -0.7386E-06,
     &  -0.6544E-06,  -0.5750E-06
     &     /)

            ddepo3 (1,1:nlat) = (/
     &  -0.8050E-07,  -0.8050E-07,  -0.8050E-07,  -0.8050E-07,
     &  -0.8141E-07,  -0.9189E-07,  -0.9964E-07,  -0.8924E-07,
     &  -0.8122E-07,  -0.8459E-07,  -0.8800E-07,  -0.9161E-07,
     &  -0.9804E-07,  -0.1125E-06,  -0.1289E-06,  -0.1500E-06,
     &  -0.1654E-06,  -0.1702E-06,  -0.1707E-06,  -0.1645E-06,
     &  -0.1633E-06,  -0.1689E-06,  -0.1703E-06,  -0.1672E-06,
     &  -0.1672E-06,  -0.1702E-06,  -0.1804E-06,  -0.1962E-06,
     &  -0.2125E-06,  -0.2290E-06,  -0.2371E-06,  -0.2406E-06,
     &  -0.2491E-06,  -0.2598E-06,  -0.2547E-06,  -0.2439E-06,
     &  -0.2264E-06,  -0.2071E-06,  -0.1814E-06,  -0.1545E-06,
     &  -0.1331E-06,  -0.1125E-06,  -0.9978E-07,  -0.8783E-07,
     &  -0.8398E-07,  -0.8050E-07
     &     /)

          ddeph2o2 (1,1:nlat) = (/
     &  -0.3680E-06,  -0.3680E-06,  -0.3719E-06,  -0.4617E-06,
     &  -0.5493E-06,  -0.6140E-06,  -0.6939E-06,  -0.8752E-06,
     &  -0.1035E-05,  -0.1094E-05,  -0.1139E-05,  -0.1133E-05,
     &  -0.1123E-05,  -0.1101E-05,  -0.1076E-05,  -0.1045E-05,
     &  -0.1022E-05,  -0.1014E-05,  -0.1014E-05,  -0.1023E-05,
     &  -0.1024E-05,  -0.1016E-05,  -0.1014E-05,  -0.1019E-05,
     &  -0.1019E-05,  -0.1014E-05,  -0.9985E-06,  -0.9747E-06,
     &  -0.9501E-06,  -0.9250E-06,  -0.9128E-06,  -0.9073E-06,
     &  -0.8945E-06,  -0.8783E-06,  -0.8397E-06,  -0.7932E-06,
     &  -0.7702E-06,  -0.7538E-06,  -0.6903E-06,  -0.6169E-06,
     &  -0.6313E-06,  -0.6588E-06,  -0.5789E-06,  -0.4887E-06,
     &  -0.4277E-06,  -0.3680E-06
     &     /)

        ddepch3o2h (1,1:nlat) = (/
     &  -0.1150E-07, -0.1150E-07, -0.1288E-07, -0.4457E-07,
     &  -0.7557E-07, -0.9923E-07, -0.1280E-06, -0.1912E-06,
     &  -0.2470E-06, -0.2680E-06, -0.2840E-06, -0.2824E-06,
     &  -0.2795E-06, -0.2730E-06, -0.2655E-06, -0.2559E-06,
     &  -0.2489E-06, -0.2467E-06, -0.2465E-06, -0.2493E-06,
     &  -0.2498E-06, -0.2473E-06, -0.2467E-06, -0.2481E-06,
     &  -0.2481E-06, -0.2467E-06, -0.2421E-06, -0.2349E-06,
     &  -0.2275E-06, -0.2200E-06, -0.2163E-06, -0.2147E-06,
     &  -0.2108E-06, -0.2060E-06, -0.1919E-06, -0.1747E-06,
     &  -0.1651E-06, -0.1578E-06, -0.1333E-06, -0.1053E-06,
     &  -0.1086E-06, -0.1167E-06, -0.8747E-07, -0.5469E-07,
     &  -0.3284E-07, -0.1150E-07
     &     /)

        ddepbc (1,1:nlat) = (/
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06
     &                                                      /)
        ddepoc (1,1:nlat) = (/
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06, -0.1150E-06, -0.1150E-06,
     &     -0.1150E-06, -0.1150E-06
     &                                                      /)
           ddepref (1,1:nlat) = (/
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
     &   0.00, 0.00, 0.00, 0.00, 0.00, 0.00
     &     /)
#endif
#endif

	namelist /chem_name_list/bio_uptake,
     &				 svi_intensity,
     &				 nhr_for_chem

!	-----------------------------------------------------

#if ( defined CPL_CHEM )

c--------------------------------------------------
c   Read control parameters from namelist:
c
c      open(120,file='INCLUDE/chem.nml',status='old')
C  open statment moved to assign.inc
        read(120,nml=chem_name_list)
        close(120)

c--------------------------------------------------
c   Pressure at each vertical layer in hPa for
c     photochemistry:

#if ( N_LEV == 9 )
      airpress( 1) = 959.0
      airpress( 2) = 894.0
      airpress( 3) = 786.0
      airpress( 4) = 634.0
      airpress( 5) = 468.0
      airpress( 6) = 321.0
      airpress( 7) = 201.0
      airpress( 8) = 103.0
      airpress( 9) = 027.0
#endif

#if ( N_LEV == 11 )
      airpress( 1) = 959.0
      airpress( 2) = 894.0
      airpress( 3) = 786.0
      airpress( 4) = 634.0
      airpress( 5) = 468.0
      airpress( 6) = 321.0
      airpress( 7) = 201.0
      airpress( 8) = 122.0
      airpress( 9) =  78.0
      airpress(10) =  42.0
      airpress(11) =  17.0
#endif

c--------------------------------------------------
c   Read solar radiative flux spectrum data:
c
c      read(163,101)specdata
c101   format(6e11.3)

c--------------------------------------------------
       print *,'cheminit emissions for ',nchemyr,'years'
c   Read integrated daily emission data:
c
!     read(164)edailyf11,
!    &         edailyf12,
!    &         edailyn2o,
!    &         edailyco,
!    &         edailynox,
!    &         edailych4,
!    &         edailyso2,
!    &         edailyco2,
!    &	       edailyhfc134a,
!    &	       edailypfc,
!    &	       edailysf6,
!    &	       edailyuco,
!    &         edailyunmv,
!    &         edailyunox,
!    &         edailyusox,
!    &	       edailybc,
!    &	       edailynh3,
!    &	       edailyoc,
!    &	       edailyubc,
!    &	       edailyunh3,
!    &         edailyuoc,
!    &	       n_total_urban,
!    &	       n_urban
     
!       Changed by Chien on October 27 of 2008
!       bc and oc emissions are scaled based on Bond
!	edailybc=edailybc*8.6/13.3
!	edailyoc=edailyoc*33.4/54.

c--------------------------------------------------
c   Read rk table:
c
	read(165)rktable1
	read(165)rktable2

!
! --- 121800
! --- moved from chememission.F
!
! Lightning produced NO emission data, 062795:
!   based on Kumar et al., 1995:
!
	xnoxltnt = 1.072e+4
	
c 092295
c ===== For start a new run:
c
	if(ISTRT1.eq.0)then
c--------------------------------------------------
c    Reading data in unit of ppb(m) = 1.e-9 kg/kg
c            from a given data set to initialize
c            simulation:

      read(163)cfc11
      read(163)cfc12
      read(163)xn2o
      read(163)o3
      read(163)co
      read(163)zco2
      read(163)ch4
      read(163)bcarbon
      read(163)ocarbon

c
c 022796
c
      read(160)ho
      read(160)ho2
      read(160)h2o2
      read(160)xno
      read(160)xno2
      read(160)ch2o
      read(160)so2

c
c 051598
c
	read(162)o3top
	close(162)

      do 2 i=1,n3d
        cfc110(i,1,1) = cfc11(i,1,1)
2     continue

      do 3 j=1,nlat
      do 3 i=1,nlon

c 061695 add o3 top array:
c      o3top  (i,j) = o3(i,j,nlev)

      do 4 k=1,nlev
       atomo (i,j,k) = 0.0
       o1d   (i,j,k) = 0.0
       atomh (i,j,k) = 0.0
       xno3  (i,j,k) = 0.0
       xn2o5 (i,j,k) = 0.0
       hno3  (i,j,k) = 0.0
       ch3   (i,j,k) = 0.0
       cho   (i,j,k) = 0.0
       ch3o  (i,j,k) = 0.0
       ch3o2 (i,j,k) = 0.0
       ch3o2h(i,j,k) = 0.0
       hoso2 (i,j,k) = 0.0
       so3   (i,j,k) = 0.0
       h2so4 (i,j,k) = 0.0
       
       hfc134a (i,j,k) = 0.0
       sf6     (i,j,k) = 0.0

        ! === if hfc, pfc, and sf6 are included:
#if ( defined INC_3GASES )
          pfc(i,j,k) = cfc11(i,j,k)/127.0/137.3675
     &	    	     *55.0*88.0		!use f11 to derive CF4
					!initial value (55pptv at 1977)

!pfc(i,j,k) = xn2o(i,j,k)/279.0/44.0 * 40.0 * 88.0 / 1e3
!                 use n2o to derive CF4 initial value:  40 pptv at 1892 

#else
	  pfc(i,j,k) = 0.0
#endif

4     continue
3     continue

#if ( defined INC_3GASES )
!      10/28/2008
!     reading hfc, pfc, and sf6 from initfile for Dec 1990
      print *, 'reading hfc, pfc, and sf6 from initfile '
      read(161)hfc134a
      read(161)pfc
      read(161)sf6
	close(161)
#endif

	do i=1,n3d
	  sviod(i,1,1) = 0.0
	enddo

c----------------------------------------------
c Calculate initial chemical field:
c
c first give a average flux to drive the photochemistry:
c
      do i=1,n3d
        solarflux(i,1,1) = 600.0
      enddo

c call ss and solver to derive the initial values:

c      call chemtrop0(1, pT,qv,3600.0,1)

      do i=1,n3d
        solarflux(i,1,1) = 0.0
      enddo

	endif

c 092295
c ===== For renew a run:
c
	if(ISTRT1.eq.1)then

c  open(179,file='DUMP/renewchem.dat',
c    &             form='unformatted',
c    &             status='unknown')
C  open statment moved to assign.inc
C    file number changed to 279

	read(279)iyearchem,mymonth,airmass,
     &              cfc11  ,cfc110,
     &              cfc11m ,
     &              cfc11sd,
     &              cfc12  ,cfc12m,
     &              cfc12sd,
     &              xn2o   ,xn2om ,
     &              xn2osd ,
     &		    hfc134a,hfc134am,
     &		    pfc    ,pfcm ,
     &		    sf6    ,sf6m ,
     &		    bcarbon,bcm  ,
     &		    ocarbon,ocm  ,
     &              atomo  ,
     &              o1d    ,
     &              o3     ,o3m  ,
     &              co     ,com  ,
     &              zco2   ,zco2m,
     &              atomh  ,
     &              ho     ,
     &              ho2    ,hoxm ,
     &              h2o2   ,
     &              xno    ,
     &              xno2   ,xnoxm,
     &              xno3   ,
     &              xn2o5  ,xnoym,
     &              hno3   ,
     &              ch4    ,ch4m ,
     &              ch3    ,
     &              cho    ,
     &              ch2o   ,
     &              ch3o   ,
     &              ch3o2  ,
     &              ch3o2h ,
     &              so2    ,so2m ,
     &              hoso2  ,
     &              so3    ,
     &              h2so4  ,h2so4m,
     &              sviod  ,sviodm
     
	close(279)

c	mymonth = mymonth + 1
c	if(mymonth.gt.12)then
c	  myyear = myyear + 1
c	  mymonth= 1
c	endif

	endif

c----------------------------------------------
c   Set monthstep = 0 and start monthly average
c       calculation:
c
      monthstep = 0
      do i=1,n3d
        cfc11m  (i,1,1) = 0.0
        cfc12m  (i,1,1) = 0.0
        xn2om   (i,1,1) = 0.0
        o3m     (i,1,1) = 0.0
        com     (i,1,1) = 0.0
        zco2m   (i,1,1) = 0.0
        hoxm    (i,1,1) = 0.0
        xnoxm   (i,1,1) = 0.0
        xnoym   (i,1,1) = 0.0
        ch4m    (i,1,1) = 0.0
        so2m    (i,1,1) = 0.0
        h2so4m  (i,1,1) = 0.0
        sviodm  (i,1,1) = 0.0
	
	hfc134am(i,1,1) = 0.0
	pfcm    (i,1,1) = 0.0
	sf6m	(i,1,1) = 0.0
	
	bcm     (i,1,1) = 0.0
	ocm     (i,1,1) = 0.0
	bcodm   (i,1,1) = 0.0
	ocodm   (i,1,1) = 0.0
      enddo

c------------------------------------------
c  Write initial field into files:
c
!      write(6,199)cfc11
!      write(6,199)cfc12
!      write(6,199)xn2o
!      write(6,199)o3
!      write(6,199)co
!      write(6,199)zco2
!      write(6,199)ch4
199   format(6e11.3)

!      write(166)cfc11
!      write(166)cfc12
!      write(166)xn2o

!      write(171)o3
!      write(171)o1d
!      write(171)ho
!      write(171)ho2
!      write(171)h2o2

!      write(172)xno
!      write(172)xno2
!      write(172)xno3
!      write(172)xn2o5
!      write(172)hno3

!      write(173)co
!      write(173)zco2
!      write(173)ch4
!      write(173)ch2o

!      write(174)so2
!      write(174)hoso2
!      write(174)so3
!      write(174)h2so4

#endif

       return
        end

